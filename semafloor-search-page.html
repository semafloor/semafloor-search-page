<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="semafloor-search-page-theme.html">

<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icons/social-icons.html">
<!-- <link rel="import" href="../iron-list/iron-list.html"> -->

<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="../paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../paper-input/paper-input.html">
<!-- <link rel="import" href="../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html"> -->
<link rel="import" href="../paper-toggle-button/paper-toggle-button.html">

<script src="../lodash/lodash.min.js" charset="utf-8"></script>

<!--
An element providing a solution to no problem in particular.

Example:

    <semafloor-search-page></semafloor-search-page>

@group Seed Elements
@element semafloor-search-page
@demo demo/index.html
@hero hero.svg
-->
<dom-module id="semafloor-search-page">

  <template>
    <style include="semafloor-search-page-theme"></style>

    <div class="date-container search-item">
      <div class="date-icon-column item-icon-column">
        <iron-icon icon="icons:query-builder"></iron-icon>
      </div>
      <div class="date-column item-data-column">
        <div class="all-day-row">
          <span>All-day</span>
          <div></div>
          <paper-toggle-button></paper-toggle-button>
        </div>
        <div class="from-date-row">
          <paper-button>[[_fromDate]]</paper-button>
          <div></div>
          <paper-button>[[_fromTime]]</paper-button>
        </div>
        <div class="to-date-row">
          <paper-button>[[_fromDate]]</paper-button>
          <div></div>
          <paper-button>[[_fromTime]]</paper-button>
        </div>
      </div>
    </div>

    <div class="capacity-container search-item">
      <div class="capacity-icon-column item-icon-column">
        <iron-icon icon="social:person-add"></iron-icon>
      </div>
      <div class="capacity-column item-data-column">
        <div class="capacity-row">
          <paper-button on-tap="_addPerson">[[_capacity]]</paper-button>
          <div></div>
        </div>
      </div>
    </div>

    <paper-dialog id="addPersonDialog" with-backdrop>
      <h2>Add Person</h2>
      <paper-dialog-scrollable>
        <p>
          numerum nec posse intrare
          <paper-input label="capacity" type="number" min="1" max="99" value="{{_inputCap::input}}" placeholder="1"></paper-input>
        </p>
      </paper-dialog-scrollable>
      <div class="buttons">
        <paper-button dialog-dismiss>Cancel</paper-button>
        <paper-button dialog-confirm on-tap="_updateCapacity">ok</paper-button>
      </div>
    </paper-dialog>
  </template>

</dom-module>

<script>

  var _notafulldate = new Date();
  var _notayear = _notafulldate.getFullYear();
  var _notamonth = _notafulldate.getMonth();
  var _notadate = _notafulldate.getDate();
  var _today = _notayear + '-' + (_notamonth + 1) + '-' + _notadate;
  var _time = _notafulldate.toTimeString().slice(0, 5);

  Polymer({

    is: 'semafloor-search-page',

    properties: {

      _capacity: {
        type: Number,
        value: 1
      },
      _inputCap: Number,
      _totalCap: {
        type: Array,
        value: function () {
          return _.fill(Array(99), 1)
        }
      },
      _toDate: {
        type: String,
        value: function () {
          return  _today;
        }
      },
      _toTime: {
        type: String,
        value: function () {
          return _time;
        }
      },
      _fromDate: {
        type: String,
        value: function () {
          return _today;
        }
      },
      _fromTime: {
        type: String,
        value: function () {
          return _time;
        }
      },

    },

    // Element Lifecycle

    ready: function() {
      // `ready` is called after all elements have been configured, but
      // propagates bottom-up. This element's children are ready, but parents
      // are not.
      //
      // This is the point where you should make modifications to the DOM (when
      // necessary), or kick off any processes the element wants to perform.
    },

    attached: function() {
      // `attached` fires once the element and its parents have been inserted
      // into a document.
      //
      // This is a good place to perform any work related to your element's
      // visual state or active behavior (measuring sizes, beginning animations,
      // loading resources, etc).
    },

    detached: function() {
      // The analog to `attached`, `detached` fires when the element has been
      // removed from a document.
      //
      // Use this to clean up anything you did in `attached`.
    },

    // Element Behavior

    /**
     * The `semafloor-search-page-lasers` event is fired whenever `fireLasers` is called.
     *
     * @event semafloor-search-page-lasers
     * @detail {{sound: String}}
     */

     _addPerson: function (ev) {
       console.log(ev.target.tagName);
       var _target = ev.target;

       if (_target && _target.tagName === 'PAPER-BUTTON') {
         this.$.addPersonDialog.open();
       }
     },

     _updateCapacity: function (ev) {
       console.log(this._capacity);
       this.set('_capacity', this._inputCap);
     },

  });

</script>
