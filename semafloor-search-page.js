"use strict";var _notafulldate=new Date,_notayear=_notafulldate.getFullYear(),_notamonth=_notafulldate.getMonth(),_notadate=_notafulldate.getDate(),_time=_notafulldate.toTimeString().slice(0,5),_sitesArray=["Any Site","KLB - Tower 5","KLB - Tower 2A","SUITE"],_floorsArray=["Any Floor","Level 1","Level 2","Level 3","Level 3A","Level 5","Level 6","Level 7","Level 8","Level 9","Level 10","Level 11","Level 12"],_typesArray=["ar","pb","pca","pcv","pj","pcf","pf","spf","sb","tp","tv","wg"],_typesResult=[0,0,0,0,0,0,0,0,0,0,0,0],_bodyTarget,_roomTypes=["Adjoining Room (Operable Wall)","Panaboard","Polycom CX100 (Audio)","Polycom CX5000 (Video Conferencing)","Projector","Projector Cable Faulty","Projector Faulty","Screen Projector Faulty","SmartBoard 800","Telepresence","TV","Writing Glass Board"],_floorsCode=["","01level","02level","03level","04level","05level","06level","07level","08level","09level","10level","11level","12level"];Polymer({is:"semafloor-search-page",properties:{_allDayToggle:{type:Boolean,value:!1},_capacity:{type:Number,value:1},_allFloors:{type:Array,value:function(){return _floorsArray}},_inputFloor:{type:String,value:"Any Floor"},_floor:{type:String,value:"Any Floor"},_floors:{type:String,value:""},_allSites:{type:Array,value:function(){return _sitesArray}},_inputSite:{type:String,value:"Any Site"},_site:{type:String,value:"Any Site"},_sites:{type:String,value:""},_inputCap:Number,_totalCap:{type:Array,value:function(){return _.fill(Array(99),1)}},_toDate:{type:String,value:function(){return[_notayear,("0"+(_notamonth+1)).slice(-2),_notadate].join("-")}},_toTime:{type:String,value:function(){return _time}},_fromDate:{type:String,value:function(){return[_notayear,("0"+(_notamonth+1)).slice(-2),_notadate].join("-")}},_fromTime:{type:String,value:function(){return _time}},_types:String,_emptyRoomResult:Object,_resultSites:Array,_resultFloors:Array,_selectedSiteTab:{type:Number,value:0},_selectedFloorTab:{type:Number,value:0},_floorsOfSites:Array,_roomsOfFloors:Array,_loadSearchResult:{type:Number,value:0},_selectedRoomInfo:Object,_tapRipple:{type:Boolean,value:!1},_roomIdx:Number,_reserveRoomMsg:String,_hideSiteToolbar:{type:Boolean,value:!1},_skipComputeSelected:Boolean,_prevFloor:String},observers:["_hideTime(_allDayToggle)","_showFloorsInTab(_emptyRoomResult, _selectedSiteTab)","_setPrevFloor(_selectedFloorTab)","_showRoomsInTab(_emptyRoomResult, _selectedSiteTab, _selectedFloorTab)"],ready:function(){},attached:function(){var e=this.$.optionsDialog;e.animationConfig={entry:{name:"transform-animation",node:e,transformFrom:"translateY(100%)",transformTo:"translateY(0)"},exit:{name:"transform-animation",node:e,transformFrom:"translateY(0)",transformTo:"translateY(100%)"}}},detached:function(){},_addPerson:function(e){var t=e.target;t&&"PAPER-BUTTON"===t.tagName&&this.$.addPersonDialog.open(),t=null},_updateCapacity:function(e){this.set("_capacity",this._inputCap)},_addSite:function(e){var t=e.target;t&&"PAPER-BUTTON"===t.tagName&&this.$.addSiteDialog.open(),t=null},_updateSite:function(){var e=_.indexOf(_sitesArray,this._inputSite);if(0>e)return this.set("_floor","Any Floor"),this.set("_floors",""),this.set("_inputFloor","Any Floor"),this.set("_sites",""),void this.set("_site","Any Site");var t=["","alpha","beta","gamma"][e],o=""===t||"alpha"===t?"Any Floor":"suite"===t?"Level 1":"Level 3";this.set("_floor",o),this.set("_floors","Any Floor"===o?"":o),this.set("_inputFloor",o),this.set("_sites",t),this.set("_site",this._inputSite)},_addFloor:function(e){var t=e.target;t&&"PAPER-BUTTON"===t.tagName&&this.$.addFloorDialog.open(),t=null},_updateFloor:function(){var e=_.indexOf(_floorsArray,this._inputFloor);return 0>e?(this.set("_floors",""),void this.set("_floor","Any Floor")):(this.set("_floors",_floorsCode[e]),void this.set("_floor",this._inputFloor))},_isDisabled:function(e,t){function o(e){var o="any"===e?"Any Floor":"suite"===e?"Level 1":"Level 3";if("any"===e)return this.set("_floor","Any Floor"),this.set("_floors",""),this.set("_inputFloor","Any Floor"),"Any Floor"!==t;var s=t===o||"Any Floor"===t;return s&&(this.set("_floor",o),this.set("_inputFloor",o),this.set("_floors",o)),!s}switch(e){case"KLB - Tower 2A":return o.call(this,"2atower");case"SUITE":return o.call(this,"suite");case"Any Site":return o.call(this,"any");default:return!1}},_addFromDate:function(e){var t=e.target;t&&"PAPER-BUTTON"===t.tagName&&this.$.fromDate.open(),t=null},_addToDate:function(e){var t=e.target;t&&"PAPER-BUTTON"===t.tagName&&this.$.toDate.open(),t=null},_addFromTime:function(e){var t=e.target;t&&"PAPER-BUTTON"===t.tagName&&this.$.fromTime.open(),t=null},_addToTime:function(e){var t=e.target;t&&"PAPER-BUTTON"===t.tagName&&this.$.toTime.open(),t=null},_hideTime:function(e){this.toggleClass("all-day-hide-time",e,this.$.fromTimeButton),this.toggleClass("all-day-hide-time",e,this.$.toTimeButton)},_getWhatBeingChecked:function(e){var t=e.target;if(t&&"PAPER-CHECKBOX"===t.tagName&&t.hasAttribute("data-checked")){var o,s,i=t.getAttribute("data-checked"),r=t.checked,a=_.indexOf(_typesArray,i);_typesResult[a]=+r,o=_typesResult.join(""),s=parseInt(o,2).toString(16),this._types=s}},_sendParams:function(e){var t="",o=this._fromTime,s=this._toTime;this._allDayToggle&&(o="08:00",s="23:30"),t="startDate="+encodeURIComponent(this._fromDate)+"&endDate="+encodeURIComponent(this._toDate)+"&tStart="+encodeURIComponent(o)+"&tEnd="+encodeURIComponent(s)+"&capacity="+encodeURIComponent(this._capacity)+"&site="+encodeURIComponent(this._sites)+"&floor="+encodeURIComponent(this._floors)+"&types="+encodeURIComponent(this._types),console.log(t),this.$.searchEmptyRoom.body=t,this.$.searchEmptyRoom.generateRequest(),this.$.responseDialog.open()},_onResponse:function(e){var t=this._isEmptyResultEmpty(this._emptyRoomResult);this.set("_skipComputeSelected",t),this._hideSiteToolbar=t,this._loadSearchResult=t?2:1,document.body.style.overflowY="hidden"},_isEmptyResultEmpty:function(e){return _.isEmpty(e)||0===e.totalEmptyRooms},_closeResponseDialog:function(e){document.body.style.overflowY=null,this.set("_selectedSiteTab",0),this.set("_selectedFloorTab",0),this.set("_loadSearchResult",0),this.set("_emptyRoomResult",null),this.$.responseDialog.close()},_computeSites:function(e){var t=_.keys(e),o=["","alpha","beta","gamma"];return t=t.filter(function(e){return"alpha"===e||"beta"===e||"gamma"===e}),this._computeFloors(t,e),t=t.map(function(e){return _sitesArray[o.indexOf(e)]}),this.set("_resultSites",t),t},_computeFloors:function(e,t){for(var o=[],s=0;s<e.length;s++)o.push(_.keys(t[e[s]]));this.set("_resultFloors",o)},_setPrevFloor:function(e){0===this._selectedSiteTab&&this.set("_prevFloor",e)},_showFloorsInTab:function(e,t){if(!this._isEmptyResultEmpty(e)){var o=["","1","2","3","3A","5","6","7","8","9","10","11","12"],s=_.keys(e),i=_.keys(e[s[t]]),i=i.map(function(e){return o[_floorsCode.indexOf(e)]});0===t?this.set("_selectedFloorTab",this._prevFloor):this.set("_selectedFloorTab",0),this.$.siteTabs.notifyResize(),this.$.floorTabs.notifyResize(),this.set("_floorsOfSites",i)}},_showRoomsInTab:function(e,t,o){if(!this._isEmptyResultEmpty(e)){var s=_.keys(e)[t],i=_.keys(e[s]);i=e[s][i[o]],this.$.siteTabs.notifyResize(),this.$.floorTabs.notifyResize(),this.set("_roomsOfFloors",i)}},_onDownRoom:function(e){for(var t=e.target;t&&"DIV"!==t.tagName;)t=t.parentElement;t&&(this.set("_tapRipple",!0),this.set("_roomIdx",t.getAttribute("room-idx")),this._computeRoomBasedOnIdx(t.getAttribute("room-idx")))},_computeRoomBasedOnIdx:function(e){var t=this._emptyRoomResult,o=_.keys(t)[this._selectedSiteTab],s=_.keys(t[o])[this._selectedFloorTab],i=t[o][s][e];this.set("_selectedRoomInfo",i)},_onUpRoom:function(e){return this._disableTap?(this.set("_disableTap",!1),void this.set("_tapRipple",!1)):(this.$.roomDialog.open(),void(document.body.querySelector("iron-overlay-backdrop").style.zIndex=103))},_onScroll:function(e){this._tapRipple&&(this.set("_disableTap",!0),this.$$("#roomRipple"+this._roomIdx).upAction())},_onVertTap:function(e){for(var t=e.target;t&&"PAPER-ICON-BUTTON"!==t.tagName;)t=t.parentElement;this.set("_roomIdx",t.getAttribute("room-idx")),this.$.optionsDialog.open()},_decodeSite:function(e){var t=["","alpha","beta","gamma"];return _sitesArray[t.indexOf(e)]},_decodeFloor:function(e){return _floorsArray[_floorsCode.indexOf(e)]},_reserveRoom:function(e){this._forceCloseOptions();var t=this.$.reserveRoomToast;this._computeRoomBasedOnIdx(this._roomIdx);var o=_.map(_.words(this._selectedRoomInfo.room),function(e){return _.capitalize(e)}).join(" "),s=o+" has been reserved successfully!";t.opened&&t.close(),this.set("_reserveRoomMsg",s),this.async(function(){t.open()})},_showRoomInfo:function(e){this._forceCloseOptions(),this._computeRoomBasedOnIdx(this._roomIdx),this.$.roomDialog.open()},_decodeTypes:function(e){var t=_.padLeft(parseInt(e,16).toString(2),12,0),o=t.split("").map(Number),s=[];return _.filter(o,function(e,t){1===e&&s.push(_roomTypes[t])}),t=null,o=null,s},_onIronOverlayOpened:function(e){this.$.roomDialog.notifyResize()},_forceCloseOptions:function(){this.$.optionsDialog.opened&&this.$.optionsDialog.close()},_onPaperRadioGroupChanged:function(e){for(var t=e.target;t&&"PAPER-DIALOG"!==t.tagName;)t=t.parentElement;t&&t.hasAttribute("site")?this._updateSite():this._updateFloor(),t.close()}});